<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>X√¨ Dz√°ch T√πy Ch·ªânh</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        background-color: #1a6e1a;
        color: white;
        margin: 0;
        padding: 20px;
        background-image: url("/sanphamxemay/image/khac/cover.png");
        background-size: cover;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: rgba(0, 0, 0, 0.7);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
      }

      h1 {
        text-align: center;
        color: #ffcc00;
        text-shadow: 2px 2px 4px #000;
        font-size: 36px;
        margin-bottom: 20px;
      }

      .setup-area {
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 30px;
      }

      .setup-controls {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: center;
        margin-bottom: 20px;
      }

      .control-group {
        display: flex;
        flex-direction: column;
        min-width: 200px;
      }

      label {
        margin-bottom: 8px;
        font-weight: bold;
        color: #ffcc00;
      }

      input,
      select {
        padding: 10px;
        border-radius: 5px;
        border: none;
        background-color: rgba(255, 255, 255, 0.9);
      }

      .player-inputs {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        justify-content: center;
      }

      .player-input {
        background-color: rgba(0, 0, 0, 0.5);
        padding: 15px;
        border-radius: 8px;
        width: 200px;
      }

      .game-area {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
      }

      .player {
        width: 280px;
        margin-bottom: 20px;
        background-color: rgba(0, 0, 0, 0.7);
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        position: relative;
      }

      .player-name {
        font-size: 20px;
        font-weight: bold;
        color: #ffcc00;
        margin-bottom: 10px;
        text-align: center;
        border-bottom: 1px solid #ffcc00;
        padding-bottom: 5px;
      }

      .player-cards {
        display: flex;
        flex-wrap: wrap;
        min-height: 120px;
        justify-content: center;
      }

      .card {
        width: 60px;
        height: 90px;
        background-color: white;
        border-radius: 5px;
        margin: 5px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 20px;
        color: black;
        position: relative;
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
      }

      .card.hearts,
      .card.diamonds {
        color: red;
      }

      .card.clubs,
      .card.spades {
        color: black;
      }

      .card-value {
        font-weight: bold;
      }

      .card-suit {
        position: absolute;
        bottom: 5px;
        right: 5px;
        font-size: 12px;
      }

      .player-info {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
        font-size: 16px;
      }

      .controls {
        text-align: center;
        margin-top: 30px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 15px;
      }

      button {
        background-color: #ffcc00;
        color: #000;
        border: none;
        padding: 12px 24px;
        font-size: 18px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
        min-width: 150px;
      }

      button:hover {
        background-color: #ffdd33;
        transform: scale(1.05);
      }

      button:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
        transform: none;
      }

      .result {
        text-align: center;
        font-size: 24px;
        font-weight: bold;
        color: #ffcc00;
        margin-top: 20px;
        min-height: 30px;
        padding: 10px;
        background-color: rgba(0, 0, 0, 0.5);
        border-radius: 8px;
      }

      .score-board {
        background-color: rgba(0, 0, 0, 0.7);
        border-radius: 10px;
        padding: 15px;
        margin-top: 20px;
      }

      .score-title {
        font-size: 20px;
        color: #ffcc00;
        margin-bottom: 10px;
        text-align: center;
      }

      .scores {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
      }

      .score-item {
        text-align: center;
        background-color: rgba(255, 204, 0, 0.2);
        padding: 8px 15px;
        border-radius: 5px;
      }

      @media (max-width: 768px) {
        .player {
          width: 100%;
        }

        .controls {
          flex-direction: column;
          align-items: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>X√¨ Dz√°ch <span>üéÆ</span></h1>
      <p>
        Tr√≤ ch∆°i ch·ªâ mang t√≠nh ch·∫•t gi·∫£i tr√≠, kh√¥ng c√≥ ƒë·ªô d∆∞·ªõi m·ªçi h√¨nh th·ª©c
      </p>

      <div class="setup-area" id="setup-area">
        <div class="setup-controls">
          <div class="control-group">
            <label for="player-count">S·ªë l∆∞·ª£ng ng∆∞·ªùi ch∆°i:</label>
            <select id="player-count" onchange="updatePlayerInputs()">
              <option value="2">2 ng∆∞·ªùi</option>
              <option value="3">3 ng∆∞·ªùi</option>
              <option value="4" selected>4 ng∆∞·ªùi</option>
              <option value="5">5 ng∆∞·ªùi</option>
              <option value="6">6 ng∆∞·ªùi</option>
            </select>
          </div>

          <div class="control-group">
            <label for="theme">Ch·ªß ƒë·ªÅ:</label>
            <select id="theme">
              <option value="motorcycle">Xe m√°y</option>
              <option value="classic">C·ªï ƒëi·ªÉn</option>
              <option value="animal">ƒê·ªông v·∫≠t</option>
              <option value="superhero">Si√™u anh h√πng</option>
            </select>
          </div>
        </div>

        <h3 style="text-align: center; color: #ffcc00; margin-top: 20px">
          ƒê·∫∑t t√™n ng∆∞·ªùi ch∆°i:
        </h3>
        <div class="player-inputs" id="player-inputs">
          <!-- Player inputs will be generated here -->
        </div>

        <div class="controls" style="margin-top: 20px">
          <button id="start-game-btn">B·∫Øt ƒë·∫ßu ch∆°i</button>
        </div>
      </div>

      <div class="game-area" id="game-area" style="display: none">
        <!-- Player areas will be generated here -->
      </div>

      <div class="controls" id="game-controls" style="display: none">
        <button id="deal-btn">Chia B√†i</button>
        <button id="hit-btn" disabled>R√∫t Th√™m</button>
        <button id="stand-btn" disabled>D·ª´ng</button>
        <button id="new-game-btn" disabled>V√°n M·ªõi</button>
      </div>

      <div class="result" id="game-result"></div>

      <div class="score-board" id="score-board" style="display: none">
        <div class="score-title">B·∫£ng ƒêi·ªÉm</div>
        <div class="scores" id="scores">
          <!-- Scores will be generated here -->
        </div>
      </div>
    </div>

    <script>
      // Bi·∫øn tr√≤ ch∆°i
      let deck = [];
      let players = [];
      let currentPlayer = 0;
      let gameStarted = false;
      let currentTheme = "motorcycle";

      // DOM elements
      const setupArea = document.getElementById("setup-area");
      const gameArea = document.getElementById("game-area");
      const playerInputs = document.getElementById("player-inputs");
      const gameControls = document.getElementById("game-controls");
      const scoreBoard = document.getElementById("score-board");
      const scoresElement = document.getElementById("scores");
      const startGameBtn = document.getElementById("start-game-btn");
      const dealBtn = document.getElementById("deal-btn");
      const hitBtn = document.getElementById("hit-btn");
      const standBtn = document.getElementById("stand-btn");
      const newGameBtn = document.getElementById("new-game-btn");
      const gameResult = document.getElementById("game-result");
      const themeSelect = document.getElementById("theme");

      // Kh·ªüi t·∫°o
      document.addEventListener("DOMContentLoaded", function () {
        updatePlayerInputs();

        // S·ª± ki·ªán n√∫t
        startGameBtn.addEventListener("click", startGame);
        dealBtn.addEventListener("click", dealCards);
        hitBtn.addEventListener("click", hit);
        standBtn.addEventListener("click", stand);
        newGameBtn.addEventListener("click", newGame);
        themeSelect.addEventListener("change", updateTheme);
      });

      // C·∫≠p nh·∫≠t theme
      function updateTheme() {
        currentTheme = themeSelect.value;
        const body = document.body;

        // X√≥a t·∫•t c·∫£ c√°c theme class c≈©
        body.classList.remove(
          "motorcycle-theme",
          "classic-theme",
          "animal-theme",
          "superhero-theme"
        );

        // Th√™m class theme m·ªõi
        switch (currentTheme) {
          case "motorcycle":
            body.style.backgroundImage =
              "url('/sanphamxemay/image/banner/ALPHARETRO.jpg')";
            break;
          case "classic":
            body.style.backgroundImage =
              "url('/sanphamxemay/image/khac/cover.png')";
            break;
          case "animal":
            body.style.backgroundImage =
              "url('/sanphamxemay/image/khac/cover.png')";
            break;
          case "superhero":
            body.style.backgroundImage =
              "url('/sanphamxemay/image/khac/cover.png')";
            break;
        }
      }

      // C·∫≠p nh·∫≠t √¥ nh·∫≠p t√™n ng∆∞·ªùi ch∆°i
      function updatePlayerInputs() {
        const playerCount = parseInt(
          document.getElementById("player-count").value
        );
        playerInputs.innerHTML = "";

        for (let i = 0; i < playerCount; i++) {
          const playerInput = document.createElement("div");
          playerInput.className = "player-input";
          playerInput.innerHTML = `
                    <label for="player-${i + 1}-name">Ng∆∞·ªùi ch∆°i ${
            i + 1
          }:</label>
                    <input type="text" id="player-${
                      i + 1
                    }-name" placeholder="Nh·∫≠p t√™n" value="${getDefaultName(i)}">
                `;
          playerInputs.appendChild(playerInput);
        }
      }

      // T·∫°o t√™n m·∫∑c ƒë·ªãnh theo theme
      function getDefaultName(index) {
        const themes = {
          motorcycle: [
            "Wave Alpha",
            "SH Mode",
            "Winner X",
            "Exciter",
            "Vision",
            "Air Blade",
          ],
          classic: ["C∆°", "R√¥", "Chu·ªìn", "B√≠ch", "Joker", "PhƒÉng teo"],
          animal: ["S∆∞ T·ª≠", "H·ªï", "G·∫•u", "C√°o", "S√≥c", "Chim"],
          superhero: [
            "Iron Man",
            "Spider-Man",
            "Batman",
            "Superman",
            "Wonder Woman",
            "Thor",
          ],
        };

        return themes[currentTheme][index] || `Ng∆∞·ªùi ch∆°i ${index + 1}`;
      }

      // B·∫Øt ƒë·∫ßu game
      function startGame() {
        const playerCount = parseInt(
          document.getElementById("player-count").value
        );
        players = [];

        // L·∫•y t√™n ng∆∞·ªùi ch∆°i
        for (let i = 0; i < playerCount; i++) {
          const nameInput = document.getElementById(`player-${i + 1}-name`);
          const name = nameInput.value.trim() || getDefaultName(i);

          players.push({
            id: i + 1,
            name: name,
            cards: [],
            score: 0,
            totalScore: 0,
            status: "waiting",
            element: `player${i + 1}`,
          });
        }

        // T·∫°o giao di·ªán ng∆∞·ªùi ch∆°i
        gameArea.innerHTML = "";
        for (let player of players) {
          const playerElement = document.createElement("div");
          playerElement.className = "player";
          playerElement.id = player.element;
          playerElement.innerHTML = `
                    <div class="player-name">${player.name}</div>
                    <div class="player-cards" id="${player.element}-cards"></div>
                    <div class="player-info">
                        <span>T·ªïng ƒëi·ªÉm: <span id="${player.element}-score">0</span></span>
                        <span>T√¨nh tr·∫°ng: <span id="${player.element}-status">ƒêang ch·ªù</span></span>
                    </div>
                `;
          gameArea.appendChild(playerElement);
        }

        // T·∫°o b·∫£ng ƒëi·ªÉm
        scoresElement.innerHTML = "";
        for (let player of players) {
          const scoreElement = document.createElement("div");
          scoreElement.className = "score-item";
          scoreElement.id = `score${player.id}`;
          scoreElement.textContent = `${player.name}: 0`;
          scoresElement.appendChild(scoreElement);
        }

        // Hi·ªÉn th·ªã khu v·ª±c ch∆°i game
        setupArea.style.display = "none";
        gameArea.style.display = "flex";
        gameControls.style.display = "flex";
        scoreBoard.style.display = "block";

        // Reset tr√≤ ch∆°i
        newGame();
      }

      // T·∫°o b·ªô b√†i
      function createDeck() {
        const suits = ["hearts", "diamonds", "clubs", "spades"];
        const values = [
          "2",
          "3",
          "4",
          "5",
          "6",
          "7",
          "8",
          "9",
          "10",
          "J",
          "Q",
          "K",
          "A",
        ];

        let newDeck = [];

        for (let suit of suits) {
          for (let value of values) {
            newDeck.push({ suit, value });
          }
        }

        return shuffleDeck(newDeck);
      }

      // X√°o b√†i
      function shuffleDeck(deck) {
        for (let i = deck.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [deck[i], deck[j]] = [deck[j], deck[i]];
        }
        return deck;
      }

      // Chia b√†i
      function dealCards() {
        if (gameStarted) return;

        deck = createDeck();
        gameStarted = true;
        currentPlayer = 0;

        // Reset ng∆∞·ªùi ch∆°i
        for (let player of players) {
          player.cards = [];
          player.score = 0;
          player.status = "waiting";
          updatePlayerDisplay(player);
        }

        // Chia 2 l√° cho m·ªói ng∆∞·ªùi
        for (let i = 0; i < 2; i++) {
          for (let player of players) {
            const card = deck.pop();
            player.cards.push(card);
            player.score = calculateScore(player.cards);
          }
        }

        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã
        for (let player of players) {
          updatePlayerDisplay(player);
        }

        // B·∫Øt ƒë·∫ßu v·ªõi ng∆∞·ªùi ch∆°i ƒë·∫ßu ti√™n
        players[0].status = "playing";
        updatePlayerDisplay(players[0]);

        // C·∫≠p nh·∫≠t n√∫t
        dealBtn.disabled = true;
        hitBtn.disabled = false;
        standBtn.disabled = false;
        newGameBtn.disabled = true;

        gameResult.textContent = "";
      }

      // R√∫t th√™m b√†i
      function hit() {
        const player = players[currentPlayer];

        if (player.status !== "playing") return;

        const card = deck.pop();
        player.cards.push(card);
        player.score = calculateScore(player.cards);

        updatePlayerDisplay(player);

        // Ki·ªÉm tra qu√° 21 ƒëi·ªÉm
        if (player.score > 21) {
          player.status = "busted";
          updatePlayerDisplay(player);
          stand();
        }
      }

      // D·ª´ng l·∫°i
      function stand() {
        const player = players[currentPlayer];
        player.status = "stood";
        updatePlayerDisplay(player);

        // Chuy·ªÉn sang ng∆∞·ªùi ch∆°i ti·∫øp theo
        currentPlayer++;

        if (currentPlayer < players.length) {
          players[currentPlayer].status = "playing";
          updatePlayerDisplay(players[currentPlayer]);
        } else {
          // K·∫øt th√∫c game
          endGame();
        }
      }

      // K·∫øt th√∫c game
      function endGame() {
        // T√¨m ng∆∞·ªùi th·∫Øng
        let winners = [];
        let maxScore = 0;

        for (let player of players) {
          if (player.status !== "busted" && player.score <= 21) {
            if (player.score > maxScore) {
              maxScore = player.score;
              winners = [player];
            } else if (player.score === maxScore) {
              winners.push(player);
            }
          }
        }

        // Hi·ªÉn th·ªã k·∫øt qu·∫£
        if (winners.length === 1) {
          gameResult.textContent = `${winners[0].name} th·∫Øng v·ªõi ${winners[0].score} ƒëi·ªÉm!`;
          winners[0].totalScore++;
          document.getElementById(
            `score${winners[0].id}`
          ).textContent = `${winners[0].name}: ${winners[0].totalScore}`;
        } else if (winners.length > 1) {
          const winnerNames = winners.map((w) => w.name).join(", ");
          gameResult.textContent = `H√≤a! ${winnerNames} c√πng c√≥ ${maxScore} ƒëi·ªÉm!`;
          // Kh√¥ng c·ªông ƒëi·ªÉm cho ai
        } else {
          gameResult.textContent = "Kh√¥ng c√≥ ng∆∞·ªùi th·∫Øng! T·∫•t c·∫£ ƒë·ªÅu qu·∫Øc!";
        }

        // C·∫≠p nh·∫≠t n√∫t
        dealBtn.disabled = true;
        hitBtn.disabled = true;
        standBtn.disabled = true;
        newGameBtn.disabled = false;
      }

      // V√°n m·ªõi
      function newGame() {
        gameStarted = false;
        currentPlayer = 0;

        // Reset ng∆∞·ªùi ch∆°i
        for (let player of players) {
          player.cards = [];
          player.score = 0;
          player.status = "waiting";
          updatePlayerDisplay(player);
        }

        // C·∫≠p nh·∫≠t n√∫t
        dealBtn.disabled = false;
        hitBtn.disabled = true;
        standBtn.disabled = true;
        newGameBtn.disabled = true;

        gameResult.textContent = "";
      }

      // T√≠nh ƒëi·ªÉm
      function calculateScore(cards) {
        let score = 0;
        let aces = 0;

        for (let card of cards) {
          if (card.value === "A") {
            score += 11;
            aces++;
          } else if (["K", "Q", "J"].includes(card.value)) {
            score += 10;
          } else {
            score += parseInt(card.value);
          }
        }

        // ƒêi·ªÅu ch·ªânh ƒëi·ªÉm n·∫øu c√≥ A v√† qu√° 21
        while (score > 21 && aces > 0) {
          score -= 10;
          aces--;
        }

        return score;
      }

      // C·∫≠p nh·∫≠t hi·ªÉn th·ªã ng∆∞·ªùi ch∆°i
      function updatePlayerDisplay(player) {
        const cardsElement = document.getElementById(`${player.element}-cards`);
        const scoreElement = document.getElementById(`${player.element}-score`);
        const statusElement = document.getElementById(
          `${player.element}-status`
        );

        // X√≥a b√†i c≈©
        cardsElement.innerHTML = "";

        // Hi·ªÉn th·ªã b√†i m·ªõi
        for (let card of player.cards) {
          const cardElement = document.createElement("div");
          cardElement.className = `card ${card.suit}`;

          const valueElement = document.createElement("div");
          valueElement.className = "card-value";
          valueElement.textContent = card.value;

          const suitElement = document.createElement("div");
          suitElement.className = "card-suit";

          // Bi·ªÉu t∆∞·ª£ng ch·∫•t b√†i
          switch (card.suit) {
            case "hearts":
              suitElement.textContent = "‚ô•";
              break;
            case "diamonds":
              suitElement.textContent = "‚ô¶";
              break;
            case "clubs":
              suitElement.textContent = "‚ô£";
              break;
            case "spades":
              suitElement.textContent = "‚ô†";
              break;
          }

          cardElement.appendChild(valueElement);
          cardElement.appendChild(suitElement);
          cardsElement.appendChild(cardElement);
        }

        // C·∫≠p nh·∫≠t ƒëi·ªÉm v√† tr·∫°ng th√°i
        scoreElement.textContent = player.score;

        switch (player.status) {
          case "waiting":
            statusElement.textContent = "ƒêang ch·ªù";
            statusElement.style.color = "white";
            break;
          case "playing":
            statusElement.textContent = "ƒêang ch∆°i";
            statusElement.style.color = "yellow";
            break;
          case "stood":
            statusElement.textContent = "ƒê√£ d·ª´ng";
            statusElement.style.color = "lightgreen";
            break;
          case "busted":
            statusElement.textContent = "Qu·∫Øc";
            statusElement.style.color = "red";
            break;
        }
      }
    </script>
  </body>
</html>
